---
import Entry from "@/components/blog/BlogEntry.astro";
import { cn } from "@/lib/utils";
import type { Gallery } from "interfaces/gallery";
import fetchApi from "lib/strapi";

const galleries = await fetchApi<Gallery[]>({
  endpoint: "/galleries",
  wrappedByKey: "data",
});

console.log(galleries);
---

<!-- Last Entries -->
<section class="py-8 pt-12">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <h2 class="text-4xl font-bold">Ãšltimas Galerias</h2>
      </div>
    </div>
    <div
      class={cn(
        "flex flex-col md:flex-row items-center flex-wrap gap-4 justify-around py-4",
        {
          "justify-start": galleries.length < 3,
        }
      )}
    >
      {
        // Render just 3 posts here if exists
        galleries.length > 0 && galleries.length > 3 ? (
          galleries
            .slice(0, 3)
            .map((post) => (
              <Entry
                title={post.attributes.title}
                description={post.attributes.description}
                pubDate={new Date(post.attributes.publishedAt)}
                slug={post.attributes.slug}
                cover={post.attributes.images.data[0].attributes.formats.thumbnail.url}
              />
            ))
        ) : galleries.length > 0 ? (
          galleries.map((post) => (
            <Entry
              title={post.attributes.title}
              description={post.attributes.description}
              pubDate={new Date(post.attributes.publishedAt)}
              slug={post.attributes.slug}
              cover={post.attributes.images.data[0].attributes.formats.thumbnail.url}
            />
          ))
        ) : (
          <p>Ningun post encontrado</p>
        )
      }
      <div class="hidden md:block xl:hidden">
        {
          // Render the 4th post if exists
          galleries.length > 3 && (
            <Entry
              title={galleries[3].attributes.title}
              description={galleries[3].attributes.description}
              pubDate={new Date(galleries[3].attributes.publishedAt)}
              slug={galleries[3].attributes.slug}
              cover={galleries[3].attributes.images.data[0].attributes.formats.thumbnail.url}
            />
          )
        }
      </div>
    </div>
  </div>
</section>
